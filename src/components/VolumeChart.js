import React, { useState, useEffect } from 'react'
import { Chart } from 'react-chartjs-2';
import "chartjs-adapter-moment";

import {
    Chart as ChartJS,
    TimeScale,
    LinearScale,
    BarElement,
    Title,
    Tooltip,
    Legend,
    PointElement,
    LineElement,
    CategoryScale,
} from 'chart.js';

const VolumeChart = () => {

    ChartJS.register(
        TimeScale,
        LinearScale,
        BarElement,
        PointElement,
        LineElement,
        CategoryScale,
        Title,
        Tooltip,
        Legend
    );

    let volume = [
        [
            1653569400000,
            "0.1566028640851198"
        ],
        [
            1653655800000,
            "201.6775170894662333"
        ],
        [
            1653742200000,
            "462.9253515927564765"
        ],
        [
            1653828600000,
            "566.5326570762534848"
        ],
        [
            1653915000000,
            "423.9425337936628571"
        ],
        [
            1654001400000,
            "848.3190260614402124"
        ],
        [
            1654087800000,
            "541.8650558415586718"
        ],
        [
            1654174200000,
            "328.4058724023802468"
        ],
        [
            1654260600000,
            "527.8154199850694797"
        ],
        [
            1654347000000,
            "405.8439500833453138"
        ],
        [
            1654433400000,
            "539.596096735464606"
        ],
        [
            1654519800000,
            "594.7303496471852011"
        ],
        [
            1654606200000,
            "556.7382822839002588"
        ],
        [
            1654692600000,
            "515.97907925977236"
        ],
        [
            1654779000000,
            "544.0599007105864629"
        ],
        [
            1654865400000,
            "432.2166843859503914"
        ],
        [
            1654951800000,
            "348.7011165361139311"
        ],
        [
            1655038200000,
            "267.9328464911505367"
        ],
        [
            1655124600000,
            "262.3859304870497717"
        ],
        [
            1655211000000,
            "344.3296465341527208"
        ],
        [
            1655297400000,
            "418.0518951037675677"
        ],
        [
            1655383800000,
            "274.5797926094567933"
        ],
        [
            1655470200000,
            "293.0968200798438983"
        ],
        [
            1655556600000,
            "745.3872910238866734"
        ],
        [
            1655643000000,
            "724.8212184975182939"
        ],
        [
            1655729400000,
            "858.7942945976625031"
        ],
        [
            1655815800000,
            "308.0304851065076174"
        ],
        [
            1655902200000,
            "299.6169148338924856"
        ],
        [
            1655988600000,
            "289.8701902292254187"
        ],
        [
            1656075000000,
            "258.5832023503341024"
        ],
        [
            1656161400000,
            "119.565945496138525"
        ],
        [
            1656247800000,
            "131.0757880996465421"
        ],
        [
            1656334200000,
            "110.9383230034358066"
        ],
        [
            1656420600000,
            "122.5336830683557229"
        ],
        [
            1656507000000,
            "136.9086865872339324"
        ],
        [
            1656593400000,
            "97.1755440409855011"
        ],
        [
            1656679800000,
            "166.6971205271579296"
        ],
        [
            1656766200000,
            "119.5230750476282981"
        ],
        [
            1656852600000,
            "127.4402211611635594"
        ],
        [
            1656939000000,
            "95.8081206591847338"
        ],
        [
            1657025400000,
            "117.035872683953567"
        ],
        [
            1657111800000,
            "58.2670787413182191"
        ],
        [
            1657198200000,
            "147.2847416135544735"
        ],
        [
            1657284600000,
            "186.2663393017774663"
        ],
        [
            1657371000000,
            "113.0228299589009143"
        ],
        [
            1657457400000,
            "76.2146977997667747"
        ],
        [
            1657543800000,
            "81.9783994777682512"
        ],
        [
            1657630200000,
            "74.3197393901081954"
        ],
        [
            1657716600000,
            "117.1015221293995987"
        ],
        [
            1657803000000,
            "115.2462696300366364"
        ],
        [
            1657889400000,
            "83.6619099894281166"
        ],
        [
            1657975800000,
            "114.3780841855088496"
        ],
        [
            1658062200000,
            "103.3625221871878918"
        ],
        [
            1658148600000,
            "135.1613430678278341"
        ],
        [
            1658235000000,
            "113.1453566864501462"
        ],
        [
            1658321400000,
            "84.8934742234695129"
        ],
        [
            1658407800000,
            "70.7351912020651497"
        ],
        [
            1658494200000,
            "132.0656841911267075"
        ],
        [
            1658580600000,
            "87.5268330521568201"
        ],
        [
            1658667000000,
            "84.4457294845503101"
        ],
        [
            1658753400000,
            "82.5135315304054385"
        ],
        [
            1658839800000,
            "72.2434554191498896"
        ],
        [
            1658926200000,
            "81.7556653086081172"
        ],
        [
            1659012600000,
            "137.6387315623037279"
        ],
        [
            1659099000000,
            "98.7398202713833396"
        ],
        [
            1659185400000,
            "99.3370438352923039"
        ],
        [
            1659271800000,
            "61.0247262059085317"
        ],
        [
            1659358200000,
            "65.4846909875732573"
        ],
        [
            1659444600000,
            "84.2254878006149057"
        ],
        [
            1659531000000,
            "70.4830777052733867"
        ]
    ]

    const makeVolumeInfo = function (array) {
        let newArray = []
        for (let i = 0; i < array.length; i++) {
            let date = array[i][0]
            let value = Number(array[i][1])
            newArray.push({ x: date, y: value })
        }
        console.log(newArray)
        return newArray
    }

    let volumeChart = makeVolumeInfo(volume)
    
    const volumeChartData = {
        datasets: [{
            type: 'bar',
            label: 'Daily Volume',
            data: volumeChart,
            backgroundColor: 'rgba(235, 99, 132, 0.8)',
        }],
    };

    const volumeChartOptions = {
        responsive: true,
        plugins: {
            legend: {
                position: 'top',
            },
            title: {
                display: true,
                text: 'ZigZag Exchange Volume (BTC)',
            },
        },
        scales: {
            x: {
                type: 'time',
                time: {
                    unit: 'day'
                }
            }
        }
    };


    return (
        <>
            <Chart options={volumeChartOptions} data={volumeChartData}></Chart>
        </>
    )
}

export default VolumeChart;